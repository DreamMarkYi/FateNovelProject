# é€‰æ‹©åˆ†æ”¯åŠŸèƒ½ä½¿ç”¨è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

NovelShowPage ç°åœ¨æ”¯æŒå®Œæ•´çš„ Galgame é€‰æ‹©åˆ†æ”¯åŠŸèƒ½ï¼ŒåŒ…æ‹¬ï¼š
- âœ… é€‰æ‹©åˆ†æ”¯æ˜¾ç¤ºå’Œäº¤äº’
- âœ… é€‰æ‹©å†å²è®°å½•
- âœ… æ¸¸æˆå˜é‡ç³»ç»Ÿï¼ˆå½±å“ç»“å±€ï¼‰
- âœ… å­˜æ¡£/è¯»æ¡£ç³»ç»Ÿï¼ˆæ”¯æŒ10ä¸ªæ§½ä½ï¼‰
- âœ… å¿«é€Ÿå­˜æ¡£/è‡ªåŠ¨å­˜æ¡£
- âœ… é€‰æ‹©è®°å½•æŸ¥çœ‹
- âœ… è°ƒè¯•æ¨¡å¼

## å¦‚ä½•ä½¿ç”¨

### 1. å¯åŠ¨æ¸¸æˆ

è®¿é—®é¡µé¢æ—¶å¯ä»¥é€šè¿‡URLå‚æ•°é…ç½®ï¼š

```
http://localhost:5173/novel-show?scriptId=fate-prologue&debug=true&playerId=player123
```

**URLå‚æ•°è¯´æ˜ï¼š**
- `scriptId`: å‰§æœ¬IDï¼ˆé»˜è®¤ï¼šfate-prologueï¼‰
- `debug`: æ˜¯å¦æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ï¼ˆtrue/falseï¼‰
- `playerId`: ç©å®¶IDï¼ˆé»˜è®¤è‡ªåŠ¨ç”Ÿæˆï¼‰
- `startScene`: èµ·å§‹åœºæ™¯ç´¢å¼•ï¼ˆå¯é€‰ï¼‰

### 2. æ¸¸æˆæ“ä½œ

#### åŸºæœ¬æ“ä½œ
- **ç‚¹å‡»å±å¹•**ï¼šæ¨è¿›å‰§æƒ…ï¼ˆæ ‡é¢˜é¡µå’Œå¯¹è¯é¡µï¼‰
- **ç‚¹å‡»é€‰æ‹©æŒ‰é’®**ï¼šåœ¨é€‰æ‹©åˆ†æ”¯åœºæ™¯æ—¶åšå‡ºé€‰æ‹©
- **ç‚¹å‡»èœå•æŒ‰é’®ï¼ˆâ˜°ï¼‰**ï¼šæ‰“å¼€æ¸¸æˆèœå•

#### èœå•åŠŸèƒ½
- **ğŸ’¾ å¿«é€Ÿå­˜æ¡£**ï¼šä¿å­˜åˆ°æ§½ä½99
- **ğŸ“ å­˜æ¡£**ï¼šé€‰æ‹©æ§½ä½1-10ä¿å­˜æ¸¸æˆ
- **ğŸ“‚ è¯»æ¡£**ï¼šä»å·²æœ‰å­˜æ¡£ç»§ç»­æ¸¸æˆ
- **ğŸ“œ é€‰æ‹©è®°å½•**ï¼šæŸ¥çœ‹æ‰€æœ‰é€‰æ‹©å†å²
- **ğŸ› è°ƒè¯•**ï¼šåˆ‡æ¢è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º

### 3. é€‰æ‹©åˆ†æ”¯åœºæ™¯

å½“é‡åˆ°é€‰æ‹©åˆ†æ”¯æ—¶ï¼š
1. å±å¹•ä¸‹æ–¹ä¼šæ˜¾ç¤ºé€‰æ‹©æç¤ºæ–‡å­—
2. æ˜¾ç¤ºå¤šä¸ªé€‰æ‹©æŒ‰é’®ï¼ˆå¸¦ç¼–å·ï¼‰
3. ç‚¹å‡»ä»»æ„é€‰æ‹©æŒ‰é’®åšå‡ºé€‰æ‹©
4. æ¸¸æˆä¼šæ ¹æ®é€‰æ‹©è·³è½¬åˆ°å¯¹åº”åœºæ™¯

**é€‰æ‹©ç¼–å·å¿«æ·é”®ï¼š** ï¼ˆå°†æ¥å¯ä»¥å®ç°ï¼‰
- æŒ‰æ•°å­—é”® 1-4 å¿«é€Ÿé€‰æ‹©

### 4. å­˜æ¡£ç³»ç»Ÿ

#### å­˜æ¡£æ•°æ®åŒ…å«ï¼š
- å½“å‰åœºæ™¯ä½ç½®
- é€‰æ‹©å†å²è®°å½•
- æ¸¸æˆå˜é‡çŠ¶æ€
- æ—¶é—´æˆ³

#### å­˜æ¡£ç±»å‹ï¼š
- **æ‰‹åŠ¨å­˜æ¡£**ï¼šæ§½ä½ 1-10
- **å¿«é€Ÿå­˜æ¡£**ï¼šæ§½ä½ 99ï¼ˆèœå•å¿«æ·æŒ‰é’®ï¼‰
- **è‡ªåŠ¨å­˜æ¡£**ï¼šæ¯5ä¸ªåœºæ™¯è‡ªåŠ¨ä¿å­˜

#### å­˜æ¡£ä½ç½®ï¼š
å­˜æ¡£ä¿å­˜åœ¨æµè§ˆå™¨çš„ localStorage ä¸­ï¼Œæ ¼å¼ä¸ºï¼š
```
save_${playerId}_${scriptId}_${slot}
```

### 5. é€‰æ‹©å†å²å’Œæ¸¸æˆå˜é‡

#### é€‰æ‹©å†å²è®°å½•
æ¯æ¬¡åšå‡ºé€‰æ‹©éƒ½ä¼šè®°å½•ï¼š
- åœºæ™¯ç´¢å¼•
- åœºæ™¯æè¿°
- é€‰æ‹©çš„ç´¢å¼•å’Œæ–‡æœ¬
- è·³è½¬ç›®æ ‡
- æ—¶é—´æˆ³

æŸ¥çœ‹æ–¹å¼ï¼š
1. æ‰“å¼€èœå• â†’ é€‰æ‹©è®°å½•
2. æˆ–æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯

#### æ¸¸æˆå˜é‡ç³»ç»Ÿ
æ¯ä¸ªé€‰æ‹©ä¼šæ›´æ–°æ¸¸æˆå˜é‡ï¼š
```javascript
gameVariables = {
  choice_4: {
    index: 0,
    text: "é€‰æ‹©å¬å”¤Saber",
    jumpTo: 10
  },
  choice_12: {
    index: 1,
    text: "ç»§ç»­è°ƒæŸ¥",
    jumpTo: 25
  }
}
```

è¿™äº›å˜é‡å¯ä»¥ç”¨äºï¼š
- æ¡ä»¶åˆ†æ”¯åˆ¤æ–­
- ç»“å±€åˆ¤å®š
- æˆå°±è§£é”
- CGè§£é”

## ç¤ºä¾‹å‰§æœ¬

### fate-prologue å‰§æœ¬ç»“æ„

```
åœºæ™¯0: æ ‡é¢˜é¡µ
  â†“
åœºæ™¯1-3: åºç« å¯¹è¯
  â†“
åœºæ™¯4: é€‰æ‹©åˆ†æ”¯ (å¬å”¤è‹±çµ)
  â”œâ†’ é€‰æ‹©1: Saber â†’ è·³è½¬åˆ°åœºæ™¯10
  â”œâ†’ é€‰æ‹©2: Archer â†’ è·³è½¬åˆ°åœºæ™¯20
  â””â†’ é€‰æ‹©3: Lancer â†’ è·³è½¬åˆ°åœºæ™¯30

åœºæ™¯10-11: Saberè·¯çº¿
åœºæ™¯20-21: Archerè·¯çº¿
åœºæ™¯30-31: Lancerè·¯çº¿
```

## æ•°æ®ç»“æ„

### é€‰æ‹©åœºæ™¯æ•°æ®æ ¼å¼

```javascript
{
  index: 4,
  type: 'choice',
  speaker: 'æ—ç™½',
  text: 'æ­¤æ—¶ï¼Œä¸€ä¸ªèº«å½±å‡ºç°åœ¨äº†ä½ çš„é¢å‰...',
  bgImage: 'https://example.com/bg.jpg',
  theme: 'dark',
  choices: [
    {
      text: 'é€‰æ‹©å¬å”¤Saber',
      jumpTo: 10,
      condition: '' // å¯é€‰ï¼šæ¡ä»¶è¡¨è¾¾å¼
    },
    {
      text: 'é€‰æ‹©å¬å”¤Archer',
      jumpTo: 20
    },
    {
      text: 'é€‰æ‹©å¬å”¤Lancer',
      jumpTo: 30
    }
  ],
  tags: ['choice', 'servant-selection']
}
```

### å­˜æ¡£æ•°æ®æ ¼å¼

```javascript
{
  scriptId: 'fate-prologue',
  scriptName: 'Fate/Stay Night - åºç« ',
  currentIndex: 5,              // æ•°ç»„ç´¢å¼•
  currentSceneIndex: 10,        // åœºæ™¯index
  sceneName: 'Saberå¬å”¤æˆåŠŸ',
  choiceHistory: [
    {
      sceneIndex: 4,
      sceneName: 'é€‰æ‹©è‹±çµ',
      choiceIndex: 0,
      choiceText: 'é€‰æ‹©å¬å”¤Saber',
      jumpTo: 10,
      timestamp: '2024-01-01T12:00:00Z'
    }
  ],
  gameVariables: {
    choice_4: {
      index: 0,
      text: 'é€‰æ‹©å¬å”¤Saber',
      jumpTo: 10
    }
  },
  timestamp: '2024-01-01T12:05:00Z',
  playTime: 300
}
```

## é«˜çº§åŠŸèƒ½

### 1. æ¡ä»¶åˆ†æ”¯ï¼ˆé¢„ç•™ï¼‰

å¯ä»¥åœ¨ choices ä¸­æ·»åŠ  condition å­—æ®µï¼š

```javascript
choices: [
  {
    text: 'ä½¿ç”¨ä»¤å’’',
    jumpTo: 50,
    condition: 'gameVariables.commandSeals > 0'
  }
]
```

### 2. ç»“å±€åˆ¤å®šï¼ˆé¢„ç•™ï¼‰

æ ¹æ® gameVariables åˆ¤å®šç»“å±€ï¼š

```javascript
// åœ¨ç»“å±€åœºæ™¯åˆ¤æ–­
if (gameVariables.choice_4?.index === 0 && 
    gameVariables.choice_15?.index === 1) {
  // True Ending - Saberè·¯çº¿
  jumpTo = 100;
} else if (...) {
  // Good Ending
  jumpTo = 101;
} else {
  // Normal Ending
  jumpTo = 102;
}
```

### 3. æˆå°±ç³»ç»Ÿï¼ˆé¢„ç•™ï¼‰

å¯ä»¥åŸºäºé€‰æ‹©å†å²è§£é”æˆå°±ï¼š

```javascript
// æ£€æŸ¥æ˜¯å¦å®Œæˆäº†æ‰€æœ‰Saberè·¯çº¿çš„é€‰æ‹©
const saberChoices = choiceHistory.filter(c => 
  c.choiceText.includes('Saber')
);
if (saberChoices.length >= 5) {
  unlockAchievement('saber_master');
}
```

## è°ƒè¯•åŠŸèƒ½

### è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º

å¯ç”¨è°ƒè¯•æ¨¡å¼åï¼ˆURLå‚æ•° `?debug=true` æˆ–èœå•åˆ‡æ¢ï¼‰ï¼Œå±å¹•å³ä¸Šè§’ä¼šæ˜¾ç¤ºï¼š
- å½“å‰å‰§æœ¬åç§°
- å½“å‰åœºæ™¯ç´¢å¼•
- æ¸¸æˆè¿›åº¦ç™¾åˆ†æ¯”
- é€‰æ‹©æ¬¡æ•°
- ç©å®¶ID

### æ§åˆ¶å°æ—¥å¿—

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼š
- åœºæ™¯æ¸²æŸ“æ—¥å¿—
- é€‰æ‹©è®°å½•
- æ¸¸æˆå˜é‡æ›´æ–°
- å­˜æ¡£æ“ä½œ

## æ³¨æ„äº‹é¡¹

1. **å­˜æ¡£å…¼å®¹æ€§**
   - ä¿®æ”¹å‰§æœ¬ç»“æ„åï¼Œæ—§å­˜æ¡£å¯èƒ½æ— æ³•æ­£å¸¸åŠ è½½
   - å»ºè®®åœ¨å‰§æœ¬æ›´æ–°æ—¶å¢åŠ ç‰ˆæœ¬å·

2. **æµè§ˆå™¨é™åˆ¶**
   - localStorage æœ‰å¤§å°é™åˆ¶ï¼ˆé€šå¸¸5-10MBï¼‰
   - æ¸…é™¤æµè§ˆå™¨æ•°æ®ä¼šåˆ é™¤æ‰€æœ‰å­˜æ¡£

3. **åœºæ™¯ç´¢å¼•**
   - åœºæ™¯çš„ `index` å­—æ®µå¿…é¡»å”¯ä¸€
   - `jumpTo` å¿…é¡»æŒ‡å‘å­˜åœ¨çš„åœºæ™¯ç´¢å¼•

4. **æ€§èƒ½ä¼˜åŒ–**
   - å¤§å‹å‰§æœ¬å»ºè®®ä½¿ç”¨åœºæ™¯åˆ†æ®µåŠ è½½
   - é¢„åŠ è½½å…³é”®åœºæ™¯çš„èƒŒæ™¯å›¾ç‰‡

## é”®ç›˜å¿«æ·é”®ï¼ˆè§„åˆ’ï¼‰

å°†æ¥å¯ä»¥å®ç°ï¼š
- `Space` æˆ– `Enter`ï¼šæ¨è¿›å‰§æƒ…
- `Ctrl+S`ï¼šå¿«é€Ÿå­˜æ¡£
- `Ctrl+L`ï¼šå¿«é€Ÿè¯»æ¡£
- `Ctrl+H`ï¼šå†å²å›æº¯
- `ESC`ï¼šæ‰“å¼€/å…³é—­èœå•
- `1-9`ï¼šé€‰æ‹©åˆ†æ”¯å¿«æ·é”®

## æ‰©å±•å»ºè®®

1. **äº‘å­˜æ¡£**ï¼šå°†å­˜æ¡£åŒæ­¥åˆ°åç«¯æœåŠ¡å™¨
2. **å›æ”¾ç³»ç»Ÿ**ï¼šåŸºäºé€‰æ‹©å†å²å›æº¯å‰§æƒ…
3. **åˆ†æ”¯é¢„è§ˆ**ï¼šæ˜¾ç¤ºé€‰æ‹©å¯èƒ½å¯¼è‡´çš„ç»“å±€
4. **ç»Ÿè®¡ç³»ç»Ÿ**ï¼šè®°å½•ç©å®¶æ¸¸ç©æ•°æ®
5. **å¤šå‘¨ç›®**ï¼šè®°å½•å·²å®Œæˆçš„è·¯çº¿å’Œç»“å±€

## æ•…éšœæ’é™¤

### é—®é¢˜1: é€‰æ‹©æŒ‰é’®ä¸æ˜¾ç¤º
- æ£€æŸ¥åœºæ™¯ `type` æ˜¯å¦ä¸º `'choice'`
- æ£€æŸ¥ `choices` æ•°ç»„æ˜¯å¦å­˜åœ¨ä¸”ä¸ä¸ºç©º
- æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

### é—®é¢˜2: é€‰æ‹©åæ²¡æœ‰è·³è½¬
- æ£€æŸ¥ `jumpTo` çš„åœºæ™¯ç´¢å¼•æ˜¯å¦å­˜åœ¨
- æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
- ç¡®è®¤åœºæ™¯æ•°æ®å·²æ­£ç¡®åŠ è½½

### é—®é¢˜3: å­˜æ¡£è¯»å–å¤±è´¥
- æ£€æŸ¥å­˜æ¡£æ•°æ®æ˜¯å¦æŸå
- ç¡®è®¤ playerId å’Œ scriptId æ˜¯å¦åŒ¹é…
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜é‡è¯•

### é—®é¢˜4: è‡ªåŠ¨å­˜æ¡£ä¸å·¥ä½œ
- ç¡®è®¤å·²æ¨è¿›åˆ°ç¬¬5ä¸ªåœºæ™¯
- æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰å­˜æ¡£æ—¥å¿—
- éªŒè¯ localStorage æ˜¯å¦å¯ç”¨

## å¼€å‘è€…æç¤º

### ä¿®æ”¹å­˜æ¡£é€»è¾‘

ä¿®æ”¹ `saveToSlot()` å‡½æ•°æ·»åŠ æ›´å¤šæ•°æ®ï¼š

```javascript
const saveData = {
  ...existingData,
  achievements: unlockedAchievements.value,
  cgGallery: unlockedCGs.value,
  playTime: gameTimer.value
};
```

### æ·»åŠ æ¡ä»¶åˆ¤æ–­

åœ¨ `handleChoice()` ä¸­æ·»åŠ æ¡ä»¶æ£€æŸ¥ï¼š

```javascript
const handleChoice = (choice, index) => {
  // æ£€æŸ¥æ¡ä»¶
  if (choice.condition) {
    const result = evaluateCondition(choice.condition);
    if (!result) {
      alert('ä¸æ»¡è¶³æ¡ä»¶');
      return;
    }
  }
  // ç»§ç»­æ­£å¸¸å¤„ç†...
};
```

---

æ›´æ–°æ—¶é—´ï¼š2024-12-09
ç‰ˆæœ¬ï¼š1.0.0












